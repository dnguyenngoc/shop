{"ast":null,"code":"import axios from 'axios';\nvar API_V1 = \"http://10.1.133.3:8081/api/v1/\";\nexport default function isUserLogin() {\n  var freshToken = localStorage.getItem('freshToken');\n  var accessToken = localStorage.getItem('accessToken');\n  var isRemember = localStorage.getItem('isRemember');\n  var expireAccessToken = localStorage.getItem('expireAccessToken');\n  var expireFreshToken = localStorage.getItem('expireFreshToken');\n  expireAccessToken = new Date(expireAccessToken);\n  expireFreshToken = new Date(expireFreshToken);\n  var d1 = new Date();\n  var now = new Date(d1.getUTCFullYear(), d1.getUTCMonth(), d1.getUTCDate(), d1.getUTCHours(), d1.getUTCMinutes(), d1.getUTCSeconds());\n  var bodyFreshToken = new FormData();\n  bodyFreshToken.append(\"refresh_token\", freshToken);\n  var check = false;\n  if (accessToken === null) return check;else if (expireAccessToken > now) {\n    check = true;\n    console.log(\"good token\");\n    return check;\n  } else if (expireFreshToken < now) {\n    console.log(\"bad token\");\n    return check;\n  } else if (expireAccessToken < now && expireFreshToken && isRemember === true) {\n    console.log(\"refresh token\");\n    axios({\n      method: \"post\",\n      url: API_V1 + \"account/login/refresh-token\",\n      data: bodyFreshToken,\n      headers: {\n        \"Content-Type\": \"multipart/form-data\"\n      }\n    }).then(function (response) {\n      if (response.status === 200) {\n        check = true;\n        var data = response.data;\n        localStorage.setItem('tokenType', data.token_type);\n        localStorage.setItem('accessToken', data.access_token);\n        localStorage.setItem('freshToken', data.refresh_token);\n        localStorage.setItem('expireAccessToken', data.expire_token);\n        localStorage.setItem('expireFreshToken', data.expire_refresh_token);\n        console.log(\"save new token\");\n        return check;\n      } else {\n        localStorage.clear();\n        console.log(\"fresh error token\");\n        return check;\n      }\n    }).catch(function (response) {\n      localStorage.clear();\n      console.log(\"api error token\");\n      return check;\n    });\n  } else {\n    console.log(\"khac\");\n    return check;\n  }\n}","map":{"version":3,"sources":["/home/pot/project/shop/frontend/src/services/token.js"],"names":["axios","API_V1","isUserLogin","freshToken","localStorage","getItem","accessToken","isRemember","expireAccessToken","expireFreshToken","Date","d1","now","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","bodyFreshToken","FormData","append","check","console","log","method","url","data","headers","then","response","status","setItem","token_type","access_token","refresh_token","expire_token","expire_refresh_token","clear","catch"],"mappings":"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","sourcesContent":["import axios from 'axios';\n\n\nconst API_V1 = \"http://10.1.133.3:8081/api/v1/\"\n\n\nexport default function isUserLogin(){\n    const freshToken = localStorage.getItem('freshToken');\n    const accessToken = localStorage.getItem('accessToken');\n    const isRemember = localStorage.getItem('isRemember');\n    var expireAccessToken = localStorage.getItem('expireAccessToken');\n    var expireFreshToken = localStorage.getItem('expireFreshToken');\n    expireAccessToken = new Date(expireAccessToken)\n    expireFreshToken = new Date(expireFreshToken)\n    var d1 = new Date();\n    var now = new Date( d1.getUTCFullYear(), d1.getUTCMonth(), d1.getUTCDate(), d1.getUTCHours(), d1.getUTCMinutes(), d1.getUTCSeconds() );\n    const bodyFreshToken = new FormData();\n    bodyFreshToken.append(\"refresh_token\", freshToken);\n    let check = false\n\n\n    if (accessToken === null) return check\n    else if (expireAccessToken > now) {\n        check = true\n        console.log(\"good token\")\n        return check\n    }\n    else if (expireFreshToken < now) {\n        console.log(\"bad token\")\n        return check\n    }\n    else if (expireAccessToken < now && expireFreshToken && isRemember === true){\n        console.log(\"refresh token\")\n        axios({\n            method: \"post\",\n            url: API_V1 + \"account/login/refresh-token\",\n            data: bodyFreshToken,\n            headers: { \"Content-Type\": \"multipart/form-data\" },\n        }).then(function (response) {\n            if (response.status === 200){\n                check = true\n                const data = response.data\n                localStorage.setItem('tokenType', data.token_type)\n                localStorage.setItem('accessToken', data.access_token)        \n                localStorage.setItem('freshToken', data.refresh_token)   \n                localStorage.setItem('expireAccessToken', data.expire_token)   \n                localStorage.setItem('expireFreshToken', data.expire_refresh_token) \n                console.log(\"save new token\")\n                return check\n\n            }\n            else {\n                localStorage.clear()\n                console.log(\"fresh error token\")\n                return check\n            }\n        }).catch(function (response) {\n            localStorage.clear();\n            console.log(\"api error token\")\n            return check\n        });\n    }\n    else {\n        console.log(\"khac\")\n        return check\n    }\n}"]},"metadata":{},"sourceType":"module"}